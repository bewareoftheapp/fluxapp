{% extends 'base.html' %}

{% block content %}

<div class="grid-container">
    <h3>Requisição #{{ request.id }}: {{ request.type }}</h3>
    <div class="callout">
        <div>Requerente: {{ request.requester.first_name }} {{ request.requester.last_name }}</div>
        <div>Valor: R$ {{ request.value|floatformat:2 }}</div>
        <div>
            <div>Descrição:</div>
            <div>{{ request.description }}</div>
        </div>
    </div>
    <div class="callout grid-y grid-padding-y">
        <h4>
            Aprovação
            {% if request.approval == None %}
            <span class="warning label">Pendente</span>
            {% elif request.approval %}
            <span class="success label">Aprovado</span>
            {% else %}
            <span class="alert label">Negado</span>
            {% endif %}
        </h4>
        {% if user.is_staff %}
        <div class="small-12 cell">
            <div><strong>Avaliar</strong></div>
            <span class="float-left">{{ user.first_name }} {{ user.last_name }}</span>
            <span class="float-right small button-group">
                <a href="{% url 'set_approval' request.id 'aprovar' %}" class="success button">Aprovar</a>
                <a href="{% url 'set_approval' request.id 'negar' %}" class="alert button">Negar</a>
            </span>
        </div>
        {% endif %}
        {% if request.approval_set %}
        {% for approval in request.approval_set %}
        <div class="small-12 cell">
            <div><strong>Aprovação #{{ approval.id }}</strong></div>
            <div>
                <span class="float-left">{{ approval.approver.first_name }} {{ approval.approver.last_name }}</span>
                {% if approval.status %}
                <span class="float-right success label">APROVADO</span>
                {% else %}
                <span class="float-right alert label">NEGADO</span>
                {% endif %}
            </div>

            {% if approval.message %}
            <div>{{ approval.message }}</div>
            {% endif %}
        </div>
        {% endfor %}
        {% endif %}
    </div>
</div>

{% endblock %}